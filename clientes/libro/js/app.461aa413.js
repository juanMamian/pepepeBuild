(function(t){function e(e){for(var o,r,s=e[0],u=e[1],c=e[2],f=0,l=[];f<s.length;f++)r=s[f],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&l.push(i[r][0]),i[r]=0;for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(t[o]=u[o]);d&&d(e);while(l.length)l.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,s=1;s<n.length;s++){var u=n[s];0!==i[u]&&(o=!1)}o&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var o={},i={app:0},a=[];function r(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=o,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/libro/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var d=u;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"0d62":function(t,e,n){"use strict";n("fef7")},1:function(t,e){},10:function(t,e){},11:function(t,e){},12:function(t,e){},13:function(t,e){},"131b":function(t,e,n){},14:function(t,e){},2:function(t,e){},3:function(t,e){},"3c35":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAABm1BMVEUAAAB9fX2jo6NeXl6Pj4+Pj4+ioqIvLy82NjY1NTWMjIxLS0tra2uOjo4tLS1VVVWioqJXV1ehoaGhoaFdXV2Li4s5OTl5eXksLCwaGhpTU1MdHR17e3uOjo5BQUGOjo4vLy9UVFSOjo4dHR0wMDCPj49nZ2dDQ0MfHx9paWkyMjI+Pj4mJiY3NzcdHR17e3tqamqOjo6Ojo56enqgoKA7OztpaWmQkJChoaFPT08mJiY9PT2NjY2Pj49/f3+fn5+lpaVoaGh6enp7e3sdHR1oaGhTU1NBQUEvLy9UVFR7e3t7e3saGhpoaGg+Pj4dHR1qamp7e3tCQkJCQkKPj498fHweHh5paWmPj49paWlCQkJnZ2dVVVV9fX0vLy9nZ2d7e3tUVFQfHx9ra2t8fHxVVVVERERERERqampAQECPj49DQ0MzMzNVVVV6enpVVVVpaWl6enpFRUUmJiYaGhpmZmZTU1NTU1MyMjJ7e3ufn596enqPj493d3d8fHwbGxukpKRoaGhUVFQrKysaGhp7e3s/Pz8+Pj49PT291zY1AAAAgXRSTlMABlYN4txVHhcSEQoD4N6UUDAuJxgLB/39+/ba2NfHxcS7qKSej4mBdm1sZmBaWlZWUEtJSEdAOjc2NDEpHBoYCPz49vXv7+/s6+bl5ODg09HKwby7u7u6ubGwrKinp6KhoKCWlY2NgoF6eXlzcWxrY2JRT01IQz09PDs2MC8nJSDBqhNCAAABgklEQVRIx+3SRVPDQBTA8VdClTptcZeWCnVX3N3d3d0lJG352GwuDKewb4YZLv3fkskvu/N2odAfZZErkSK2WTXbDpQp5RaAkiae56tidMJZr22Ow9swIRV0y9xrOY5rtsjHBHJNRewcSSsHWzfPN9ENwFVOSL0C4MrmVABVitVyrt8OtAX3juKgcBwHqYVrNJ+vjQKiksUcyYohzKRAdtUYc/CZz/VdAibGWjvlAGRKBlAxBoMaJwzLvQM6E4rsfJDOUKfSIBAdhqh1AjkBTNGGysoNE6Ay3d4xgE4iwYq2pTUPUnSw7MgNRjBzLKkVdTILAtkHTOc9LDseAlSerdYQmP3ul59DTKdFx6gGYLa7yqrd32/MEb3sUQWi+Tuz2ewM+SjhC5PflxaRjOLkooyQ6hR4pzU1hxIwEiGLiJOHQULWJapGaXFxTRje9TKZvhTEO50YWnmCZB0hGh/ZWSBg/PUapV7NZFAtUo10PkEeMxmg7LmlrtGLvdVJFRT6v74ABqxMskl6QHIAAAAASUVORK5CYII="},4:function(t,e){},5:function(t,e){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o,i,a,r,s=n("2b0e"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("libro",{attrs:{idLibro:t.idLibroSeleccionado}})],1)},c=[],d=(n("ac1f"),n("841c"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"libro"}},[t.libro.paginas?n("div",{attrs:{id:"contenedorHojas"}},t._l(Math.ceil(t.libro.paginas.length/2),(function(e){return n("div",{key:e,staticClass:"hoja",class:{girada:e-1<t.centroHojas,tapada:Math.abs(e-1-t.centroHojas)>=1},style:[{zIndex:e-1==t.hojaMovida?"0":-Math.abs(e-1-t.hojaMovida)}]},t._l(t.libro.paginas.slice(2*(e-1),2*(e-1)+2),(function(o,i){return n("pagina",{key:o.id,class:{reverso:i%2>0},attrs:{estaPagina:o,numPagina:i+2*(e-1),idLibro:t.idLibro},nativeOn:{mousedown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:void(t.swipingPagina=!0)},mouseup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])||"button"in e&&0!==e.button?null:t.endSwipe(e)},mousemove:function(e){return t.swipePagina(e,i%2>0?"atras":"adelante",i)},mouseleave:function(e){return t.endSwipe(e)}}})})),1)})),0):t._e()])}),f=[],l=n("8785"),m=n("898b"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pagina",style:t.estilo},[t._l(t.estaPagina.cuadrosTexto,(function(t){return n("cuadro-texto",{key:t.id,attrs:{esteCuadroTexto:t}})})),t._l(t.estaPagina.cuadrosImagen,(function(e){return n("cuadro-imagen",{key:e.id,attrs:{esteCuadroImagen:e,idPagina:t.estaPagina.id,idLibro:t.idLibro}})}))],2)},g=[],h=(n("a9e3"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"cuadroImagen",class:{conAudio:t.esteCuadroImagen.audio},style:[t.estiloLayout],on:{click:t.playAudio}},[0==t.imagenLoaded?o("img",{staticClass:"simboloLoading",attrs:{src:n("3c35"),alt:"Cargando"}}):t._e(),o("img",{staticClass:"imagenContenido",attrs:{src:t.urlImagen+"?v="+t.versionImagen,alt:"ilustracion",draggable:"false"},on:{load:function(e){t.imagenLoaded=!0}}}),t.esteCuadroImagen.audio?o("audio",{ref:"audio",attrs:{type:"audio/ogg"}},[o("source",{attrs:{src:t.urlAudio,type:"audio/ogg"}})]):t._e()])}),b=[],x={name:"cuadroImagen",props:{esteCuadroImagen:Object,idLibro:String,idPagina:String,sizePagina:Object},data:function(){return{versionImagen:0,imagenLoaded:!1}},computed:{estiloLayout:function(){return{top:this.esteCuadroImagen.posicion.y+"%",left:this.esteCuadroImagen.posicion.x+"%",width:this.esteCuadroImagen.size.x+"%",height:this.esteCuadroImagen.size.y+"%",zIndex:this.esteCuadroImagen.posicionZeta}},urlImagen:function(){return this.serverUrl+"/apiCuentos/imagenCuento/"+this.idLibro+"/"+this.idPagina+"/"+this.esteCuadroImagen.id},urlAudio:function(){return this.serverUrl+"/apiCuentos/audioImagen/"+this.idLibro+"/"+this.idPagina+"/"+this.esteCuadroImagen.id}},methods:{playAudio:function(){this.esteCuadroImagen.audio&&this.$refs.audio.play()}}},y=x,v=(n("cf8f"),n("2877")),j=Object(v["a"])(y,h,b,!1,null,"2b4a8cff",null),C=j.exports,A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cuadroTexto",style:[t.estiloFormato,t.estiloLayout]},[n("div",{ref:"texto",staticClass:"texto",style:[t.estiloFontSize]},[t._v(" "+t._s(t.esteCuadroTexto.texto)+" ")]),n("div",{ref:"textoDummy",staticClass:"textoDummy",style:[t.estiloFormato,t.estiloDummy]},[t._v(" "+t._s(t.esteCuadroTexto.texto)+" ")])])},S=[],z={name:"CuadroTexto",props:{esteCuadroTexto:Object},data:function(){return{fontSizeDummy:10,fontSizeTexto:10}},computed:{estiloDummy:function(){return{fontSize:this.fontSizeDummy+"px"}},estiloFontSize:function(){return{fontSize:this.fontSizeTexto+"px"}},estiloFormato:function(){return{textAlign:this.esteCuadroTexto.formato.alineacion,color:this.esteCuadroTexto.formato.colorLetra,fontFamily:this.esteCuadroTexto.formato.tipoLetra+", 'Nunito', sans-serif"}},estiloLayout:function(){return{top:this.esteCuadroTexto.posicion.y+"%",left:this.esteCuadroTexto.posicion.x+"%",width:this.esteCuadroTexto.size.x+"%",height:this.esteCuadroTexto.size.y+"%",zIndex:this.esteCuadroTexto.posicionZeta}}},methods:{findFontSize:function(){var t=this;if(this.esteCuadroTexto&&this.esteCuadroTexto.texto&&!(this.esteCuadroTexto.texto.length<1)){var e=this.$refs.texto.offsetHeight,n=this.$refs.textoDummy.offsetHeight,o=this.$refs.textoDummy.scrollWidth,i=this.$refs.texto.offsetWidth;n>=e||o>=i?(console.log("Reduciendo font size"),this.fontSizeDummy=this.fontSizeDummy-2,this.$nextTick((function(){var e=t.$refs.texto.offsetHeight,n=t.$refs.textoDummy.offsetHeight,o=t.$refs.textoDummy.scrollWidth,i=t.$refs.texto.offsetWidth;if(n<e&&o<i||t.fontSizeDummy<5)return t.fontSizeTexto=t.fontSizeDummy,void(t.fontSizeInput=t.fontSizeDummy);t.findFontSize()}))):n<e&&o<i&&(console.log("Aumentando font size"),this.fontSizeDummy=this.fontSizeDummy+2,this.$nextTick((function(){var e=t.$refs.texto.offsetHeight,n=t.$refs.textoDummy.offsetHeight,o=t.$refs.textoDummy.scrollWidth,i=t.$refs.texto.offsetWidth;if(n>=e||o>=i||t.fontSizeDummy>100)return t.fontSizeDummy=t.fontSizeDummy-2,t.fontSizeTexto=t.fontSizeDummy,void(t.fontSizeInput=t.fontSizeDummy);t.findFontSize()})))}}},mounted:function(){var t=this;this.$nextTick((function(){t.findFontSize()}))}},L=z,P=(n("0d62"),Object(v["a"])(L,A,S,!1,null,null,null)),w=P.exports,T={components:{CuadroTexto:w,CuadroImagen:C},name:"Pagina",props:{estaPagina:Object,numPagina:Number,idLibro:String},data:function(){return{zElementos:100}},computed:{estilo:function(){return{backgroundColor:this.estaPagina.color}}}},O=T,k=(n("59c2"),Object(v["a"])(O,p,g,!1,null,"8d71ffe6",null)),I=k.exports,V=Object(m["gql"])(o||(o=Object(l["a"])(["\n  fragment fragCuadroTexto on CuadroTextoCuento {\n    id\n    texto\n    posicionZeta\n    posicion {\n      x\n      y\n    }\n    size {\n      x\n      y\n    }\n    audio {\n      tipoReproduccion\n    }\n    formato {\n      fontSize\n      colorLetra\n      tipoLetra\n      alineacion\n    }\n  }\n"]))),D=Object(m["gql"])(i||(i=Object(l["a"])(["\n  fragment fragCuadroImagen on CuadroImagenCuento {\n    id\n    sinArchivo\n    tipoActivacionSecundario\n    posicionZeta\n    posicion {\n      x\n      y\n    }\n    size {\n      x\n      y\n    }\n    audio {\n      tipoReproduccion\n    }\n  }\n"]))),H=Object(m["gql"])(a||(a=Object(l["a"])(["\n  fragment fragPagina on PaginaCuento {\n    id\n    numPag\n    color\n    cuadrosTexto {\n      ...fragCuadroTexto\n    }\n    cuadrosImagen {\n      ...fragCuadroImagen\n    }\n  }\n  ","\n  ","\n"])),V,D),M=Object(m["gql"])(r||(r=Object(l["a"])(["\n  query($idLibro: ID!) {\n    libro(idLibro: $idLibro) {\n      id\n      idsEditores\n      titulo\n      paginas {\n        ...fragPagina\n      }\n      idForo\n    }\n  }\n  ","\n"])),H),R={components:{Pagina:I},name:"Libro",apollo:{libro:{query:M,variables:function(){return{idLibro:this.idLibro}},skip:function(){return null==this.idLibro},fetchPolicy:"cache-and-network"}},props:{idLibro:String},data:function(){return{libro:{paginas:null},hojaMovida:0,centroHojas:-.5,swipingPagina:!1,swipeAcumulado:0}},methods:{swipePagina:function(t,e){this.swipingPagina&&(t.movementX<0&&"adelante"==e||t.movementX>0&&"atras"==e)&&(this.swipeAcumulado+=t.movementX)},endSwipe:function(){if(Math.abs(this.swipeAcumulado)<5)return this.swipingPagina=!1,void(this.swipeAcumulado=0);this.swipeAcumulado<0?(console.log("Avanzar una hoja"),this.navegarHojas(1)):(console.log("Retroceder una hoja"),this.navegarHojas(-1)),this.swipingPagina=!1,this.swipeAcumulado=0},navegarHojas:function(t){this.centroHojas+=t,this.hojaMovida=t<0?this.centroHojas+.5:this.centroHojas-.5}}},U=R,E=(n("ef25"),Object(v["a"])(U,d,f,!1,null,"a88422b2",null)),_=E.exports,N={components:{Libro:_},name:"App",data:function(){return{idLibroSeleccionado:null}},mounted:function(){var t=window.location.search.substring(1),e=new URLSearchParams(t),n=e.get("id");n&&(this.idLibroSeleccionado=n)}},B=N,W=(n("034f"),Object(v["a"])(B,u,c,!1,null,null,null)),F=W.exports,G=n("5530"),Q=(n("d81d"),n("99af"),n("09bf")),$=n("e312"),J=n("b7cf"),q=n("522d"),K=n("f5a8"),Z=n("a1b6");s["a"].use(q["a"]);var Y=new $["a"],X=function(){return localStorage.getItem("token")},tt="https://pe-pe-pe.herokuapp.com",et=(tt.substr(7),Object(J["a"])({uri:tt+"/graphql"})),nt=Object(K["a"])((function(t,e){var n=e.headers;return{headers:Object(G["a"])(Object(G["a"])({},n),{},{authorization:X()})}})),ot=Object(Z["a"])((function(t){t.graphQLErrors,t.networkError})),it=ot.concat(nt).concat(et),at=new Q["a"]({link:it,cache:Y,connectToDevTools:!0}),rt=new q["a"]({defaultClient:at});s["a"].config.productionTip=!1,s["a"].mixin({data:function(){return{serverUrl:tt}}}),new s["a"]({render:function(t){return t(F)},apolloProvider:rt}).$mount("#app")},"59c2":function(t,e,n){"use strict";n("8108")},6:function(t,e){},7:function(t,e){},"7f69":function(t,e,n){},8:function(t,e){},8108:function(t,e,n){},"85ec":function(t,e,n){},9:function(t,e){},cf8f:function(t,e,n){"use strict";n("131b")},ef25:function(t,e,n){"use strict";n("7f69")},fef7:function(t,e,n){}});
//# sourceMappingURL=app.461aa413.js.map